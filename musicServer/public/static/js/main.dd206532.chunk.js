(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{36:function(e,t,i){e.exports=i(76)},41:function(e,t,i){},46:function(e,t,i){},71:function(e,t,i){},72:function(e,t,i){},73:function(e,t,i){},74:function(e,t,i){},75:function(e,t,i){},76:function(e,t,i){"use strict";i.r(t);var a=i(0),n=i.n(a),s=i(33),c=i.n(s),r=(i(41),i(3)),o=i(4),u=i(6),l=i(5),d=i(7),h=i(10),m=i(20),p=(i(46),function(e){function t(){return Object(r.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{id:"musicHeader"},this.props.headerArrow&&n.a.createElement(m.b,{to:"/list"},n.a.createElement("span",null,"<")),this.props.musicName)}}]),t}(a.Component));var y=Object(h.b)(function(e){return{headerArrow:e.headerArrow,musicName:e.musicName}},function(e){return{}})(p),f=i(8),v=i(21),E=i.n(v),b=(i(71),i(72),function(e){function t(){return Object(r.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"loader"})}}]),t}(a.Component));var O=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).state={musicList:[],isLoading:!0},e.isMove=!1,e.handleMove=e.handleMove.bind(Object(f.a)(Object(f.a)(e))),e}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{id:"musicList",ref:"musicList"},n.a.createElement("ul",null,!0===this.state.isLoading?n.a.createElement(b,null):this.state.musicList.map(function(t,i){return n.a.createElement("li",{key:t.id,onTouchMove:e.handleMove,onTouchEnd:function(){e.handleEnd(t.id,t.title)},className:e.props.musicNameId===""+t.id?"active":""},n.a.createElement("div",{className:"listOrder"},i+1),n.a.createElement("div",{className:"listName"},n.a.createElement("h3",null,t.title),n.a.createElement("p",null,t.author)))})))}},{key:"componentDidMount",value:function(){var e,t=this,i=(e="musicList",window.sessionStorage.getItem(e));i?this.setState({musicList:JSON.parse(i),isLoading:!1},function(){t.listScrollTop()}):E.a.post("/api/index/index",{TransCode:"020111",OpenId:"Test",Body:{SongListId:"141998290"}}).then(function(e){if("OK"===e.data.ErrCode){var i=e.data.Body.songs;t.setState({musicList:i,isLoading:!1},function(){var e,i;t.listScrollTop(),e="musicList",i=JSON.stringify(t.state.musicList),window.sessionStorage.setItem(e,i)})}}),this.props.headerArrowFn()}},{key:"handleMove",value:function(){this.isMove=!0}},{key:"handleEnd",value:function(e,t){this.isMove?this.isMove=!1:(this.props.history.push("/pic/"+e),this.props.musicNameIdFn(e),this.props.isMusicPlayFn(),this.props.musicNameFn(t))}},{key:"listScrollTop",value:function(){for(var e=this.refs.musicList,t=e.getElementsByTagName("li"),i=0;i<t.length;i++)t[i].className&&(e.scrollTop=t[i].offsetTop)}}]),t}(a.Component);var N=Object(h.b)(function(e){return{musicNameId:e.musicNameId}},function(e){return{headerArrowFn:function(){e({type:"HEADERARROW_CHANGE",payload:!1})},musicNameIdFn:function(t){e({type:"MUSICNAMEID_CHANGE",payload:t})},isMusicPlayFn:function(){e({type:"ISMUSICPLAY_CHANGE",payload:!0})},musicNameFn:function(t){e({type:"MUSICNAME_CHANGE",payload:t})}}})(O),g=(i(73),function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).state={lyricList:[],active:-1},e.handleTouch=e.handleTouch.bind(Object(f.a)(Object(f.a)(e))),e}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{id:"musicLyric"},n.a.createElement("ul",{ref:"musicLyricUl",onTouchStart:this.handleTouch},this.state.lyricList.map(function(t,i){return n.a.createElement("li",{key:i,className:e.state.active===i?"active":""},t.lyric)})))}},{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;E.a.get("/music/Music/Music?id="+t+"&type=lrc").then(function(t){console.log(t.data),e.setState({lyricList:e.formatLyricData(t.data)})}),this.props.headerArrowFn(),this.props.musicNameIdFn(t),this.props.isMusicPlay?this.lyricPlay():this.lyricPause()}},{key:"componentWillReceiveProps",value:function(e){e.isMusicPlay?this.lyricPlay():this.lyricPause()}},{key:"componentWillUnmount",value:function(){this.lyricPause()}},{key:"lyricPlay",value:function(){this.playing(),this.timer=setInterval(this.playing.bind(this),500)}},{key:"lyricPause",value:function(){clearInterval(this.timer)}},{key:"playing",value:function(){for(var e=this.state.lyricList,t=document.getElementById("audio"),i=this.refs.musicLyricUl,a=i.getElementsByTagName("li")[0],n=0;n<e.length;n++)n+1<48&&e[n].time<t.currentTime&&e[n+1].time>t.currentTime&&(this.setState({active:n}),n>5&&e[n].lyric&&(i.style.top=-(n-5)*(a.offsetHeight+8)+"px"))}},{key:"handleTouch",value:function(){var e=this.props.match.params.id;this.props.history.push("/pic/"+e)}},{key:"formatLyricData",value:function(e){var t=this,i=[];return e.replace(/\[([^\]]+)\]([^[]+)/g,function(e,a,n){i.push({time:t.formatTimeToSec(a),lyric:n})}),i}},{key:"formatTimeToSec",value:function(e){var t=e.split(":");return(60*parseFloat(t[0])+parseFloat(t[1])).toFixed(2)}}]),t}(a.Component));var P=Object(h.b)(function(e){return{isMusicPlay:e.isMusicPlay}},function(e){return{headerArrowFn:function(){e({type:"HEADERARROW_CHANGE",payload:!0})},musicNameIdFn:function(t){e({type:"MUSICNAMEID_CHANGE",payload:t})}}})(g),M=(i(74),function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).handleTap=e.handleTap.bind(Object(f.a)(Object(f.a)(e))),e}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{id:"musicAudio"},n.a.createElement("div",{ref:"audioPlay",onTouchStart:this.handleTap,className:"audioPlay"}),n.a.createElement("div",{ref:"audioProgress",className:"audioProgress"},n.a.createElement("div",{ref:"audioBar",className:"audioBar"}),n.a.createElement("div",{ref:"audioNow",className:"audioNow"})),n.a.createElement("audio",{id:"audio",ref:"audio",src:this.props.musicNameId&&"/music/Music/Music?id="+this.props.musicNameId+"&type=url"}))}},{key:"componentDidUpdate",value:function(){this.props.isMusicPlay?this.audioPlay():this.audioPause()}},{key:"componentDidMount",value:function(){this.handleDrag()}},{key:"audioPlay",value:function(){this.refs.audioPlay.style.backgroundImage="url(/images/list_audioPause.png)",this.refs.audio.play(),this.playing(),this.timer=setInterval(this.playing.bind(this),1e3)}},{key:"audioPause",value:function(){this.refs.audioPlay.style.backgroundImage="url(/images/list_audioPlay.png)",this.refs.audio.pause(),clearInterval(this.timer)}},{key:"playing",value:function(){var e=this.refs.audioProgress,t=this.refs.audioBar,i=this.refs.audioNow,a=this.refs.audio,n=a.currentTime/a.duration;t.style.left=n*e.offsetWidth+"px",i.style.width=100*n+"%"}},{key:"handleTap",value:function(){if(!this.refs.audio.getAttribute("src"))return!1;this.refs.audio.paused?this.props.isMusicPlayFn(!0):this.props.isMusicPlayFn(!1)}},{key:"handleDrag",value:function(){var e=this.refs.audioProgress,t=this.refs.audioBar,i=this.refs.audioNow,a=this.refs.audio,n=0;t.ontouchstart=function(t){var s=this,c=t.changedTouches[0];return n=c.pageX-this.offsetLeft,document.ontouchmove=function(t){var c=t.changedTouches[0].pageX-n;c<0?c=0:c>e.offsetWidth&&(c=e.offsetWidth),s.style.left=c+"px";var r=c/e.offsetWidth;a.currentTime=r*a.duration,i.style.width=100*r+"%"},document.ontouchend=function(){document.ontouchmove=document.ontouchend=null},!1}}}]),t}(a.Component));var j=Object(h.b)(function(e){return{isMusicPlay:e.isMusicPlay,musicNameId:e.musicNameId}},function(e){return{isMusicPlayFn:function(t){e({type:"ISMUSICPLAY_CHANGE",payload:t})}}})(M),I=(i(75),function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).handleTouch=e.handleTouch.bind(Object(f.a)(Object(f.a)(e))),e}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{id:"musicPic"},n.a.createElement("div",{ref:"musicPic",onTouchStart:this.handleTouch},n.a.createElement("img",{src:"/music/Music/Music?id="+this.props.match.params.id+"&type=pic",alt:"\u6b4c\u66f2\u5c01\u9762"})))}},{key:"componentDidMount",value:function(){var e=this.props.match.params.id;this.props.headerArrowFn(),this.props.musicNameIdFn(e),this.props.isMusicPlay?this.picPlay():this.picPause()}},{key:"componentDidUpdate",value:function(){this.props.isMusicPlay?this.picPlay():this.picPause()}},{key:"picPlay",value:function(){this.refs.musicPic.style.animationPlayState="running"}},{key:"picPause",value:function(){this.refs.musicPic.style.animationPlayState="paused"}},{key:"handleTouch",value:function(){var e=this.props.match.params.id;this.props.history.push("/lyric/"+e)}}]),t}(a.Component));var A=Object(h.b)(function(e){return{isMusicPlay:e.isMusicPlay}},function(e){return{headerArrowFn:function(){e({type:"HEADERARROW_CHANGE",payload:!0})},musicNameIdFn:function(t){e({type:"MUSICNAMEID_CHANGE",payload:t})}}})(I),T=i(15),k=function(e){function t(){return Object(r.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return n.a.createElement(m.a,null,n.a.createElement("div",{id:"main"},n.a.createElement(y,null),n.a.createElement(T.d,null,n.a.createElement(T.b,{path:"/list",component:N}),n.a.createElement(T.b,{path:"/lyric/:id",component:P}),n.a.createElement(T.b,{path:"/pic/:id",component:A}),n.a.createElement(T.a,{from:"/*",to:"/list"})),n.a.createElement(j,null)))}}]),t}(a.Component),S=i(18);var C=Object(S.b)({headerArrow:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"HEADERARROW_CHANGE"===t.type?t.payload:e},musicNameId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"MUSICNAMEID_CHANGE"===t.type?t.payload:e},isMusicPlay:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"ISMUSICPLAY_CHANGE"===t.type?t.payload:e},musicName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u5dc5\u5cf0\u699c \xb7 \u70ed\u6b4c",t=arguments.length>1?arguments[1]:void 0;return"MUSICNAME_CHANGE"===t.type?t.payload:e}}),w=Object(S.c)(C,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());c.a.render(n.a.createElement(h.a,{store:w},n.a.createElement(k,null)),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.dd206532.chunk.js.map